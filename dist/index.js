(()=>{"use strict";var e={888:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.appDataSource=void 0;const n=o(250),r=o(241),i={type:"postgres",host:process.env.DATABASE_HOST||"localhost",port:Number(process.env.DATABASE_PORT)||5432,username:process.env.DATABASE_USERNAME||"postgres",password:process.env.DATABASE_PASSWORD||"postgres",database:process.env.DATABASE_NAME||"athlyedge",entities:r.Entities,logging:"dev"===process.env.APP_ENV||"development"===process.env.APP_ENV,synchronize:!0};t.appDataSource=new n.DataSource(i)},885:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function s(e){try{a(n.next(e))}catch(e){i(e)}}function c(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,c)}a((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BookController=void 0;const r=o(632),i=o(6);t.BookController=class{constructor(){this.bookService=new i.BookService}getMany(){return n(this,void 0,void 0,(function*(){return yield this.bookService.getMany()}))}getOne(e){const t=Number(e.params.id),o=this.bookService.getOne(t);if(!o)throw new r.HttpException(404,"Book not found");return o}create(e){return this.bookService.create(e.body)}update(e){const t=Number(e.params.id);return this.bookService.update(t,e.body)}delete(e){return n(this,void 0,void 0,(function*(){const t=Number(e.params.id);return yield this.bookService.delete(t),{message:"Book Successfully deleted"}}))}}},977:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseDTO=void 0,t.BaseDTO=class{constructor(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this[t]=e[t])}}},867:function(e,t,o){var n=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(s=(i<3?r(s):i>3?r(t,o,s):r(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseEntity=void 0;const i=o(250);class s{constructor(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this[t]=e[t])}}t.BaseEntity=s,n([(0,i.PrimaryGeneratedColumn)(),r("design:type",Number)],s.prototype,"id",void 0),n([(0,i.CreateDateColumn)(),r("design:type",Date)],s.prototype,"createdAt",void 0),n([(0,i.UpdateDateColumn)(),r("design:type",Date)],s.prototype,"updatedAt",void 0),n([(0,i.DeleteDateColumn)(),r("design:type",Date)],s.prototype,"deletedAt",void 0)},632:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HttpException=void 0;class o extends Error{constructor(e,t){super(t),this.statusCode=e,this.message=t}}t.HttpException=o},343:function(e,t,o){var n=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(s=(i<3?r(s):i>3?r(t,o,s):r(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.Book=void 0;const i=o(250),s=o(867);let c=class extends s.BaseEntity{};t.Book=c,n([(0,i.Column)(),r("design:type",String)],c.prototype,"title",void 0),n([(0,i.Column)(),r("design:type",String)],c.prototype,"isbn",void 0),t.Book=c=n([(0,i.Entity)("books")],c)},241:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Entities=void 0;const n=o(343);t.Entities=[n.Book]},607:function(e,t,o){e=o.nmd(e);var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function s(e){try{a(n.next(e))}catch(e){i(e)}}function c(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,c)}a((n=n.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.app=void 0,o(236);const i=r(o(860)),s=r(o(986)),c=r(o(142)),a=o(17),u=o(888),d=o(479);c.default.config({path:(0,a.join)(process.cwd(),".env")}),t.app=n(void 0,void 0,void 0,(function*(){const t=(0,i.default)();if(t.use(s.default.json()),global.DataSource=yield u.appDataSource.initialize(),(0,d.setupRoutes)(t),o.c[o.s]===e){const e=process.env.PORT||3e3;t.listen(e,(()=>{console.log("server started at http://localhost:"+e)}))}return t}))},254:function(e,t,o){var n=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(s=(i<3?r(s):i>3?r(t,o,s):r(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.CreateBookDTO=void 0;const i=o(849),s=o(977);class c extends s.BaseDTO{}t.CreateBookDTO=c,n([(0,i.IsNotEmpty)(),r("design:type",String)],c.prototype,"title",void 0),n([(0,i.IsNotEmpty)(),r("design:type",String)],c.prototype,"isbn",void 0)},568:function(e,t,o){var n=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(s=(i<3?r(s):i>3?r(t,o,s):r(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateBookDTO=void 0;const i=o(849),s=o(977);class c extends s.BaseDTO{}t.UpdateBookDTO=c,n([(0,i.IsNotEmpty)(),r("design:type",String)],c.prototype,"title",void 0)},348:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BookRoutes=void 0;const n=o(885),r=o(254),i=o(568),s=o(681);t.BookRoutes=[{path:"/book",method:s.RouteMethodEnum.GET,controller:n.BookController,action:"getMany"},{path:"/book/:id",method:s.RouteMethodEnum.GET,controller:n.BookController,action:"getOne"},{path:"/book",request:r.CreateBookDTO,method:s.RouteMethodEnum.POST,controller:n.BookController,action:"create"},{path:"/book/:id",request:i.UpdateBookDTO,method:s.RouteMethodEnum.PUT,controller:n.BookController,action:"update"},{path:"/book/:id",method:s.RouteMethodEnum.DELETE,controller:n.BookController,action:"delete"}]},479:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function s(e){try{a(n.next(e))}catch(e){i(e)}}function c(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,c)}a((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.setupRoutes=void 0;const r=o(849),i=o(348),s=o(681),c=o(632),a=[...i.BookRoutes];t.setupRoutes=e=>{a.forEach((t=>{const o=new t.controller;e[t.method](t.path,((e,i,a)=>n(void 0,void 0,void 0,(function*(){try{if(t.request){const o=t.method===(s.RouteMethodEnum.GET||s.RouteMethodEnum.DELETE)?e.query:e.body,n=new t.request(o),i=yield(0,r.validate)(n,{whitelist:!0,forbidNonWhitelisted:!0});if(null==i?void 0:i.length){const e={};throw null==i||i.forEach((({property:t,constraints:o})=>{e[t]=Object.values(o)})),new c.HttpException(400,e)}}const n=yield o[t.action](e,i);i.json(n)}catch(e){e instanceof c.HttpException?i.status(e.statusCode).send({statusCode:e.statusCode,message:e.message}):i.status(500).send({statusCode:500,message:e.message||e})}}))))}))}},6:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function s(e){try{a(n.next(e))}catch(e){i(e)}}function c(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,c)}a((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BookService=void 0;const r=o(343),i=o(570),s=o(632),c=o(517);t.BookService=class{constructor(){this.bookRepository=(0,i.getRepository)(r.Book)}getMany(e){return n(this,void 0,void 0,(function*(){return yield this.bookRepository.find(e)}))}getOne(e,t){return n(this,void 0,void 0,(function*(){return yield this.bookRepository.findOne(Object.assign(Object.assign({},t),{where:{id:e}}))}))}create(e){return n(this,void 0,void 0,(function*(){const t=this.bookRepository.create(e);return yield this.bookRepository.save(t),t}))}update(e,t){return n(this,void 0,void 0,(function*(){const o=yield this.bookRepository.findOneBy({id:e});if(!o)throw new s.HttpException(400,"Book not Found");const n=(0,c.omit)(t,["id","isbn","createdAt","updatedAt"]);for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&(o[e]=n[e]);return yield this.bookRepository.save(o),o}))}delete(e){var t;return n(this,void 0,void 0,(function*(){return(null===(t=this.bookRepository.metadata.columns.filter((e=>e.isDeleteDate)))||void 0===t?void 0:t.length)>0?yield this.bookRepository.softDelete(e):yield this.bookRepository.delete(e)}))}}},681:(e,t)=>{var o;Object.defineProperty(t,"__esModule",{value:!0}),t.RouteMethodEnum=void 0,function(e){e.GET="get",e.POST="post",e.PUT="put",e.DELETE="delete"}(o||(t.RouteMethodEnum=o={}))},570:(e,t)=>{function o(){return global.DataSource||null}Object.defineProperty(t,"__esModule",{value:!0}),t.getRepository=t.getDataSource=void 0,t.getDataSource=o,t.getRepository=function(e){return o().getRepository(e)}},986:e=>{e.exports=require("body-parser")},849:e=>{e.exports=require("class-validator")},142:e=>{e.exports=require("dotenv")},860:e=>{e.exports=require("express")},517:e=>{e.exports=require("lodash")},236:e=>{e.exports=require("reflect-metadata")},250:e=>{e.exports=require("typeorm")},17:e=>{e.exports=require("path")}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(i.exports,i,i.exports,o),i.loaded=!0,i.exports}o.c=t,o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),o(o.s=607)})();